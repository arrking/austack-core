<md-content layout="column" flex layout-padding id="application-settings-content">
  <md-card>
    <md-card-content>
      <span>应用包含两部分：移动客户端和服务客户端。移动客户端可以借助austack提供的服务直接支持用户的注册，登录等功能。服务客户端可以使用austack提供的API管理用户。</span>
    </md-card-content>
  </md-card>
  <div layout="row" layout-md="column" layout-sm="column">
    <md-content flex>
      <md-card layout="column">
        <h1 class="text-center">客户端（Ionic）</h1>
        <img src="assets/images/ionic.png" class="icon-large" />
        <md-card-content>
          <div class="md-actions" layout="row" layout-align="space-between center">
            <md-button class="md-primary" ng-click="vm.showClientTutorial =! vm.showClientTutorial"> 示例说明 </md-button>
            <md-button class="md-primary md-raised" ng-click="vm.downloadClient()"> 下载示例代码 </md-button>
          </div>
          <div ng-show="true || vm.showClientTutorial">
            <p>
              1. 加载预定义常量，建议放到js代码块的最前面
              <pre>
                <script src="js/austack-variables.js"></script>
              </pre>
            </p>
            <p>
              2. 加载 angular-jwt.js 和 angular-austack.js(TODO：我们代码优化后放到npm库里)
              <pre>
                <script src="lib/angular-jwt/dist/angular-jwt.js"></script>
                <script src="js/angular-austack.js"></script>
              </pre>
            </p>
            <p>
              3. 在app.js后面添加austack的config和run的代码块
              <pre>
                // austack config angular.module('starter').config(function austackConfig($stateProvider, austackProvider, jwtInterceptorProvider, $httpProvider) { $stateProvider .state('login', { url: "/login", templateUrl: "templates/login.html", controller: 'LoginCtrl' }); // Configure Austack austackProvider.init({ domain: AUSTACK_DOMAIN, clientId: AUSTACK_CLIENT_ID, loginState: 'login' }); jwtInterceptorProvider.tokenGetter = function($window, jwtHelper, austack) { var idToken = $window.localStorage.getItem('token'); var refreshToken = $window.localStorage.getItem('refreshToken'); if (!idToken || !refreshToken) { return null; } if (jwtHelper.isTokenExpired(idToken)) { return austack.refreshIdToken(refreshToken, function(idToken) { $window.localStorage.setItem('token', idToken); return idToken; }); } else { return idToken; } } $httpProvider.interceptors.push('jwtInterceptor'); }) // austack run .run(function austackRun($rootScope, austack, $window, $location, jwtHelper) { $rootScope.$on('$locationChangeStart', function() { if (austack.isAuthenticated) { return; } var token = $window.localStorage.getItem('token'); if (!token || jwtHelper.isTokenExpired(token)) { $location.path('/login'); } else { // post to dave's backend to get userInfo austack.getUserInfo(token); } }); });
              </pre>
            </p>
            <p>
              4. 添加controller 代码
              <pre>
                angular.module('starter.controllers', []) .controller('LoginCtrl', function($scope, austack, $state, $window) { console.log('start LoginCtrl'); function doAuth() { console.log('start doing signin'); austack.signin({}, function(result) { // $window.localStorage.setItem('profile', result.profile); // $window.localStorage.setItem('refreshToken', result.refreshToken); $window.localStorage.setItem('token', result.idToken); alert(result.idToken); $state.go('tab.dash'); }, function(error) { console.log(error); }); } $scope.$on('$ionic.reconnectScope', function() { doAuth(); }); doAuth(); })

              </pre>
            </p>

          </div>
        </md-card-content>
      </md-card>
    </md-content>
    <md-content flex>
      <md-card layout="column">
        <h1 class="text-center">服务器端（NodeJS）</h1>
        <img src="assets/images/nodejs.svg" class="icon-large" />
        <md-card-content>
          <div class="md-actions" layout="row" layout-align="space-between center">
            <md-button class="md-primary" ng-click="vm.showServerTutorial =! vm.showServerTutorial"> 示例说明 </md-button>
            <md-button class="md-primary md-raised" ng-click="vm.downloadBackend()"> 下载示例代码 </md-button>
          </div>
          <div ng-show="vm.showServerTutorial">
            <p>Sed porttitor lectus nibh. Nulla porttitor accumsan tincidunt. Donec rutrum congue leo eget malesuada. Pellentesque in ipsum id orci porta dapibus. Sed porttitor lectus nibh. Curabitur non nulla sit amet nisl tempus convallis quis ac lectus. Nulla porttitor accumsan tincidunt. Curabitur aliquet quam id dui posuere blandit. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Proin eget tortor risus. Cras ultricies ligula sed magna dictum porta. Curabitur aliquet quam id dui posuere blandit. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Donec velit neque, auctor sit amet aliquam vel, ullamcorper sit amet ligula. Curabitur arcu erat, accumsan id imperdiet et, porttitor at sem. Curabitur arcu erat, accumsan id imperdiet et, porttitor at sem. Vivamus magna justo, lacinia eget consectetur sed, convallis at tellus. Donec sollicitudin molestie malesuada. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Donec velit neque, auctor sit amet aliquam vel, ullamcorper sit amet ligula. Quisque velit nisi, pretium ut lacinia in, elementum id enim. Curabitur non nulla sit amet nisl tempus convallis quis ac lectus. Cras ultricies ligula sed magna dictum porta. Nulla porttitor accumsan tincidunt. Vivamus suscipit tortor eget felis porttitor volutpat. Curabitur non nulla sit amet nisl tempus convallis quis ac lectus. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Donec velit neque, auctor sit amet aliquam vel, ullamcorper sit amet ligula. Nulla porttitor accumsan tincidunt. Curabitur non nulla sit amet nisl tempus convallis quis ac lectus. Pellentesque in ipsum id orci porta dapibus. Donec sollicitudin molestie malesuada.</p>
          </div>
        </md-card-content>
      </md-card>
    </md-content>
  </div>
</md-content>