<md-content layout="column" flex layout-padding id="application-settings-content">
  <md-card>
    <md-card-content>
      <span>应用包含两部分：移动客户端和服务客户端。移动客户端可以借助austack提供的服务直接支持用户的注册，登录等功能。服务客户端可以使用austack提供的API管理用户。</span>
    </md-card-content>
  </md-card>
  <div layout="row" layout-md="column" layout-sm="column">
    <md-content flex>
      <md-card layout="column">
        <h1 class="text-center">客户端（Ionic）</h1>
        <img src="assets/images/ionic.png" class="icon-large" />
        <md-card-content>
          <div class="md-actions" layout="row" layout-align="space-between center">
            <md-button class="md-primary" ng-click="vm.showClientTutorial =! vm.showClientTutorial"> 示例说明 </md-button>
            <md-button class="md-primary md-raised" ng-click="vm.downloadClient()"> 下载示例代码 </md-button>
          </div>
          <div ng-show="!vm.showClientTutorial">
            <p>
              1. 加载预定义常量，建议放到js代码块的最前面
              <div ng-model="vm.ionicStep1" ui-ace="{useWrapMode : true, showGutter: false, theme:'github', mode: 'html'}"></div>
            </p>
            <p>
              2. 加载 angular-jwt.js 和 angular-austack.js(TODO：我们代码优化后放到npm库里)
              <div ui-ace ng-model="vm.ionicStep2" ui-ace="{useWrapMode : true, showGutter: false, theme:'github', mode: 'html'}"></div>
            </p>
            <p>
              3. 在app.js后面添加austack的config和run的代码块
              <div ui-ace ng-model="vm.ionicStep3" ui-ace="{useWrapMode : true, showGutter: false, theme:'github', mode: 'javascript'}"></div>
            </p>
            <p>
              4. 添加controller 代码
              <div ui-ace ng-model="vm.ionicStep4" ui-ace="{useWrapMode : true, showGutter: false, theme:'github', mode: 'javascript'}"></div>
            </p>
          </div>
        </md-card-content>
      </md-card>
    </md-content>
    <md-content flex>
      <md-card layout="column">
        <h1 class="text-center">服务器端（NodeJS）</h1>
        <img src="assets/images/nodejs.svg" class="icon-large" />
        <md-card-content>
          <div class="md-actions" layout="row" layout-align="space-between center">
            <md-button class="md-primary" ng-click="vm.showServerTutorial =! vm.showServerTutorial"> 示例说明 </md-button>
            <md-button class="md-primary md-raised" ng-click="vm.downloadBackend()"> 下载示例代码 </md-button>
          </div>
          <div ng-show="!vm.showServerTutorial">
            <p>
              1. app.js 设置支持cors
              <pre>
                var cors = require('cors'); app.use(cors({ origin: '*' }));
              </pre>
            </p>
            <p>
              2. app.js 设置系统启动则获得applicationJwt
              <pre>
                var Austack = require('./austack-nodejs'); Austack.getApplicationJwt() .then(function (applicationJwt) { console.log('success get applicationJwt', applicationJwt); });
              </pre>
            </p>
            <p>
              3. app.js设置路由支持已通过austack登录的客户端请求用户个人信息
              <pre>
                app.get('/me', user.me);
              </pre>
            </p>
            <p>
              4. routes/user.js 设置路由的具体实现代码
              <pre>
                var Austack = require('../austack-nodejs'); exports.me = function (req, res) { var userJwt = req.headers.authorization; Austack.validateUserJwt(userJwt) .then(function () { var profile = { clientId: clientId, userOtherInfo: 'some other userInfo dave want to add' }; console.log('success', profile); res.status(200).json(profile); }) .fail(function () { console.log('not validate'); res.status(401).json({ message: 'user force logout' }); }); };
              </pre>
            </p>
          </div>
        </md-card-content>
      </md-card>
    </md-content>
  </div>
</md-content>